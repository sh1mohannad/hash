<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="استخدم أداة التشفير والهاش لتشفير وتحويل النصوص إلى هاش بأمان. MD5، SHA-256، AES، DES، RSA وغيرهم!">
    <meta name="keywords" content="تشفير، هاش، MD5، SHA-256، AES، DES، RSA، أمان، أداة تشفير عبر الإنترنت، تشفير البيانات، أداة تشفير">
    <meta name="author" content="فريق التشفير الآمن">
    <meta property="og:title" content="أداة التشفير والهاش | MD5، SHA، AES، DES، RSA">
    <meta property="og:description" content="قم بتشفير وتحويل النصوص إلى هاش بأمان. احصل على أمان بياناتك باستخدام خوارزميات التشفير الشهيرة.">
    <meta property="og:image" content="URL_TO_IMAGE">
    <meta name="google-site-verification" content="ZHnog2yNJFAJ5Own8Meq1JK6bRphKI3CMBhwTmBHIGA" />
    <title>أداة التشفير والهاش | MD5، SHA، AES، DES، RSA</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        h1, h2 {
            color: #444;
            text-align: center;
        }
        .container {
            max-width: 700px;
            margin: 20px auto;
            padding: 25px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        input, select, button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        button {
            background: #007BFF;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 18px;
        }
        button:hover {
            background: #0056b3;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            background-color: #e4e4e4;
            border-radius: 5px;
            font-family: monospace;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9em;
            color: #777;
        }
        .key-input {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        h3 {
            margin-top: 40px;
            text-align: center;
            color: #555;
        }
        p {
            text-align: justify;
        }
    </style>
</head>
<body class="container">
    <h1>أداة التشفير والهاش</h1>
    <h2>حلول التشفير والهاش الآمنة</h2>
    <p>باستخدام هذه الأداة عبر الإنترنت، يمكنك تشفير النصوص وتحويلها إلى هاش بأمان. تدعم الأداة خوارزميات مشهورة مثل MD5 و SHA-1 و SHA-256 و AES و DES و RSA وغيرهم. حافظ على أمان بياناتك باستخدام هذه الأدوات.</p>
    
    <div>
        <label for="inputText">أدخل النص:</label>
        <input type="text" id="inputText" placeholder="اكتب النص هنا" />

        <label for="operation">اختر العملية:</label>
        <select id="operation" onchange="toggleFields()">
            <option value="MD5">هاش MD5</option>
            <option value="SHA1">هاش SHA-1</option>
            <option value="SHA256">هاش SHA-256</option>
            <option value="SHA512">هاش SHA-512</option>
            <option value="CRC32">حساب CRC-32</option>
            <option value="DES">تشفير وفك تشفير DES</option>
            <option value="Vigenere">تشفير وفك تشفير فيجنير</option>
            <option value="AES">تشفير وفك تشفير AES</option>
            <option value="Afin">تشفير وفك تشفير أفين</option>
            <option value="Sezar">تشفير قيصر</option>
            <option value="RSA">تشفير وفك تشفير RSA</option>
            <option value="Atbash">تشفير أتباش</option>
            <option value="DiffieHelman">مشاركة المفتاح ديفي-هيلمان</option>
        </select>

        <div id="additionalFields"></div>

        <button onclick="process()">تنفيذ العملية</button>

        <div id="results"></div>
    </div>
    
    <h3>خوارزميات التشفير الشهيرة</h3>
    <p><strong>MD5:</strong> هو دالة هاش 128 بت تُستخدم لضمان تكامل البيانات.</p>
    <p><strong>SHA-256:</strong> هو دالة هاش قوية تُستخدم بشكل شائع في مجال التشفير.</p>
    <p><strong>AES:</strong> هو معيار تشفير متقدم يوفر أمانًا عاليًا للبيانات.</p>
    <p><strong>RSA:</strong> هو أسلوب تشفير غير متماثل يُستخدم لنقل البيانات بأمان.</p>

    <footer>
        <p>© 2025 فريق التشفير الآمن. جميع الحقوق محفوظة.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/10.1.10/jsrsasign-all-min.js"></script>
    <script>
        function toggleFields() {
            const operation = document.getElementById('operation').value;
            const additionalFields = document.getElementById('additionalFields');
            additionalFields.innerHTML = ""; // نظف الحقول أولاً

            if (operation === "DES" || operation === "AES" || operation === "Vigenere") {
                additionalFields.innerHTML = `
                    <label for="key">المفتاح:</label>
                    <input type="text" id="key" placeholder="أدخل مفتاح التشفير" />
                `;
            } else if (operation === "Sezar") {
                additionalFields.innerHTML = `
                    <label for="sezarShift">قيمة الإزاحة:</label>
                    <input type="number" id="sezarShift" placeholder="أدخل قيمة الإزاحة" />
                `;
            } else if (operation === "Afin") {
                additionalFields.innerHTML = `
                    <label for="aValue">قيمة A:</label>
                    <input type="number" id="aValue" placeholder="أدخل قيمة A" />
                    <label for="bValue">قيمة B:</label>
                    <input type="number" id="bValue" placeholder="أدخل قيمة B" />
                `;
            } else if (operation === "RSA") {
                additionalFields.innerHTML = `
                    <label for="rsaPublicKey">المفتاح العام (RSA):</label>
                    <input type="text" id="rsaPublicKey" placeholder="أدخل المفتاح العام" />
                    <label for="rsaPrivateKey">المفتاح الخاص (RSA):</label>
                    <input type="text" id="rsaPrivateKey" placeholder="أدخل المفتاح الخاص" />
                `;
            } else if (operation === "DiffieHelman") {
                additionalFields.innerHTML = `
                    <label for="privateKey">أدخل مفتاحك الخاص:</label>
                    <input type="text" id="privateKey" placeholder="أدخل مفتاحك الخاص" />
                `;
            }
        }

        function process() {
            const text = document.getElementById('inputText').value.trim();
            const operation = document.getElementById('operation').value;
            const key = document.getElementById('key') ? document.getElementById('key').value.trim() : null;
            const shift = document.getElementById('sezarShift') ? parseInt(document.getElementById('sezarShift').value) : null;
            const a = document.getElementById('aValue') ? parseInt(document.getElementById('aValue').value) : null;
            const b = document.getElementById('bValue') ? parseInt(document.getElementById('bValue').value) : null;
            const publicKey = document.getElementById('rsaPublicKey') ? document.getElementById('rsaPublicKey').value.trim() : null;
            const privateKey = document.getElementById('rsaPrivateKey') ? document.getElementById('rsaPrivateKey').value.trim() : null;
            const userPrivateKey = document.getElementById('privateKey') ? document.getElementById('privateKey').value.trim() : null;

            const results = document.getElementById('results');
            results.innerHTML = ""; // نظف نتائج العرض

            if (!text && operation !== "DiffieHelman" && operation !== "RSA") {
                alert("الرجاء إدخال نص!");
                return;
            }

            switch (operation) {
                case "MD5":
                    results.innerHTML = `<strong>هاش MD5:</strong> ${CryptoJS.MD5(text).toString()}`;
                    break;
                case "SHA1":
                    results.innerHTML = `<strong>هاش SHA-1:</strong> ${CryptoJS.SHA1(text).toString()}`;
                    break;
                case "SHA256":
                    results.innerHTML = `<strong>هاش SHA-256:</strong> ${CryptoJS.SHA256(text).toString()}`;
                    break;
                case "SHA512":
                    results.innerHTML = `<strong>هاش SHA-512:</strong> ${CryptoJS.SHA512(text).toString()}`;
                    break;
                case "CRC32":
                    results.innerHTML = `<strong>CRC-32:</strong> ${calculateCRC32(text)}`;
                    break;
                case "DES":
                    if (key.length !== 8) {
                        alert("يجب أن يكون المفتاح لـ DES مكونًا من 8 أحرف!");
                        return;
                    }
                    const desEncrypted = CryptoJS.DES.encrypt(text, key).toString();
                    const desDecrypted = CryptoJS.DES.decrypt(desEncrypted, key).toString(CryptoJS.enc.Utf8);
                    results.innerHTML = `<strong>التشفير (DES):</strong> ${desEncrypted}<br><strong>النتيجة المفككة:</strong> ${desDecrypted}`;
                    break;
                case "AES":
                    const aesEncrypted = CryptoJS.AES.encrypt(text, key).toString();
                    const aesDecrypted = CryptoJS.AES.decrypt(aesEncrypted, key).toString(CryptoJS.enc.Utf8);
                    results.innerHTML = `<strong>التشفير (AES):</strong> ${aesEncrypted}<br><strong>النتيجة المفككة:</strong> ${aesDecrypted}`;
                    break;
                case "Vigenere":
                    if (!key) {
                        alert("الرجاء إدخال مفتاح لتشفير فيجنير!");
                        return;
                    }
                    results.innerHTML = `<strong>التشفير (Vigenère):</strong> ${vigenereEncrypt(text, key)}<br><strong>النتيجة المفككة:</strong> ${vigenereDecrypt(text, key)}`;
                    break;
                case "Sezar":
                    if (isNaN(shift)) {
                        alert("الرجاء إدخال قيمة إزاحة!");
                        return;
                    }
                    results.innerHTML = `<strong>التشفير (قيصر):</strong> ${caesarCipher(text, shift)}`;
                    break;
                case "Afin":
                    if (isNaN(a) || isNaN(b)) {
                        alert("الرجاء إدخال قيم A و B!");
                        return;
                    }
                    results.innerHTML = `<strong>التشفير (Afin):</strong> ${affineCipher(text, a, b)}`;
                    break;
                case "RSA":
                    if (!publicKey || !privateKey) {
                        alert("الرجاء إدخال المفاتيح الخاصة بـ RSA!");
                        return;
                    }
                    const rsaEncrypted = encryptWithRSA(text, publicKey);
                    const rsaDecrypted = decryptWithRSA(rsaEncrypted, privateKey);
                    results.innerHTML = `<strong>التشفير (RSA):</strong> ${rsaEncrypted}<br><strong>النتيجة المفككة:</strong> ${rsaDecrypted}`;
                    break;
                case "Atbash":
                    results.innerHTML = `<strong>التشفير (Atbash):</strong> ${atbashCipher(text)}`;
                    break;
                case "DiffieHelman":
                    if (!userPrivateKey) {
                        alert("الرجاء إدخال مفتاحك الخاص لـ Diffie-Hellman!");
                        return;
                    }
                    const p = 23; // مثال على عدد أولي
                    const g = 5;  // رقم ثابت مطلوب
                    const userPublicKey = Math.pow(g, userPrivateKey) % p;
                    results.innerHTML = `<strong>المفتاح العام للمستخدم المحسوب:</strong> ${userPublicKey}`;
                    break;
                default:
                    alert("تم اختيار عملية غير صالحة!");
                    break;
            }
        }

        function calculateCRC32(str) {
            let crc32Table = [];
            let crc32 = 0;
            for (let i = 0; i < 256; i++) {
                let c = i;
                for (let j = 8; j > 0; j--) {
                    if (c & 1) c = (c >>> 1) ^ 0xedb88320;
                    else c >>>= 1;
                }
                crc32Table[i] = c;
            }
            for (let i = 0; i < str.length; i++) {
                crc32 = (crc32 >>> 8) ^ crc32Table[(crc32 ^ str.charCodeAt(i)) & 0xff];
            }
            return (crc32 ^ 0xffffffff) >>> 0;
        }

        function vigenereEncrypt(text, key) {
            let result = '';
            let keyIndex = 0;
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const charCode = char.charCodeAt(0);
                const keyCode = key[keyIndex % key.length].charCodeAt(0);
                result += String.fromCharCode((charCode + keyCode) % 256);
                keyIndex++;
            }
            return result;
        }

        function vigenereDecrypt(text, key) {
            let result = '';
            let keyIndex = 0;
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const charCode = char.charCodeAt(0);
                const keyCode = key[keyIndex % key.length].charCodeAt(0);
                result += String.fromCharCode((charCode - keyCode + 256) % 256);
                keyIndex++;
            }
            return result;
        }

        function caesarCipher(text, shift) {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            return text.split('').map(char => {
                const index = alphabet.indexOf(char);
                if (index === -1) return char;
                return alphabet[(index + shift + alphabet.length) % alphabet.length];
            }).join('');
        }

        function affineCipher(text, a, b) {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            return text.split('').map(char => {
                const index = alphabet.indexOf(char);
                if (index === -1) return char;
                return alphabet[((a * index + b) % alphabet.length + alphabet.length) % alphabet.length];
            }).join('');
        }

        function atbashCipher(text) {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            return text.split('').map(char => {
                const index = alphabet.indexOf(char);
                if (index === -1) return char;
                return alphabet[alphabet.length - 1 - index];
            }).join('');
        }

        function encryptWithRSA(text, publicKey) {
            // تطبيق تشفير RSA باستخدام مفتاح عام
            const rsaKey = new RSAKey();
            rsaKey.readPublicKeyFromPEMString(publicKey);
            return rsaKey.encrypt(text);
        }

        function decryptWithRSA(ciphertext, privateKey) {
            // تطبيق فك تشفير RSA باستخدام المفتاح الخاص
            const rsaKey = new RSAKey();
            rsaKey.readPrivateKeyFromPEMString(privateKey);
            return rsaKey.decrypt(ciphertext);
        }
    </script>
</body>
</html>
